<div class="space-y-6">
  <div class="flex justify-between items-center">
    <h2 class="text-3xl font-bold tracking-tight text-gray-100">Transações</h2>
    <button
      (click)="openCreateForm()"
      class="bg-emerald-600 hover:bg-emerald-700 text-white px-4 py-2 rounded-lg flex items-center transition-colors"
    >
      <lucide-angular [img]="plusIcon" class="mr-2 h-4 w-4" />
      Nova Transação
    </button>
  </div>

  <!-- Loading State -->
  @if (transactionService.loading()) {
  <div class="flex justify-center items-center h-32">
    <lucide-angular
      [img]="loaderIcon"
      class="h-8 w-8 animate-spin text-emerald-500"
    />
  </div>
  }

  <!-- Error State -->
  @if (transactionService.error()) {
  <div class="bg-red-900/50 border border-red-800 rounded-lg p-4 text-red-200">
    {{ transactionService.error() }}
    <button
      (click)="loadTransactions()"
      class="ml-4 bg-red-700 hover:bg-red-600 px-3 py-1 rounded text-sm"
    >
      Tentar novamente
    </button>
  </div>
  }

  <!-- Transactions Table -->
  <div class="bg-neutral-950 border border-gray-800 rounded-lg overflow-hidden">
    <!-- Desktop Table -->
    <div class="hidden md:block">
      <div class="border-b border-gray-800 bg-neutral-900 px-6 py-3">
        <div class="grid grid-cols-12 gap-4 text-sm font-medium text-gray-400">
          <div class="col-span-4">Título</div>
          <div class="col-span-2">Valor</div>
          <div class="col-span-2">Categoria</div>
          <div class="col-span-2">Data</div>
          <div class="col-span-2 text-right">Ações</div>
        </div>
      </div>

      <div class="divide-y divide-gray-800">
        @for (transaction of transactionService.transactions(); track
        transaction.id) {
        <div class="px-6 py-4 hover:bg-gray-900/50 transition-colors">
          <div class="grid grid-cols-12 gap-4 items-center">
            <div class="col-span-4">
              <div class="flex items-center gap-3">
                <div class="p-2 rounded-full bg-gray-800">
                  <!-- Usar lucide-angular diretamente -->
                  <lucide-angular
                    [img]="getCategoryIcon(transaction.type)"
                    [class]="getCategoryColor(transaction.type)"
                    class="h-4 w-4"
                  />
                </div>
                <div>
                  <p class="font-medium text-gray-100">
                    {{ transaction.title }}
                  </p>
                  @if (transaction.receiptUrl) {
                  <p class="text-xs text-gray-400">Com comprovante</p>
                  }
                </div>
              </div>
            </div>

            <div class="col-span-2">
              <p [class]="getCategoryColor(transaction.type)">
                {{ formatCurrency(transaction.amount) }}
              </p>
            </div>

            <div class="col-span-2">
              <span
                class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-800 text-gray-300"
              >
                {{ getCategoryName(transaction.categoryId) }}
              </span>
            </div>

            <div class="col-span-2 text-gray-300">
              {{ formatDate(transaction.date) }}
            </div>

            <div class="col-span-2 text-right">
              <div class="flex justify-end gap-2">
                <button
                  (click)="openEditForm(transaction)"
                  class="p-2 text-gray-400 hover:text-gray-100 hover:bg-gray-800 rounded-lg transition-colors"
                >
                  <lucide-angular [img]="pencilIcon" class="h-4 w-4" />
                </button>
                <button
                  (click)="deleteTransaction(transaction.id)"
                  class="p-2 text-red-400 hover:text-red-100 hover:bg-red-900/50 rounded-lg transition-colors"
                >
                  <lucide-angular [img]="trashIcon" class="h-4 w-4" />
                </button>
              </div>
            </div>
          </div>
        </div>
        } @empty {
        <div class="px-6 py-12 text-center text-gray-500">
          <lucide-angular
            [img]="listIcon"
            class="h-12 w-12 mx-auto mb-4 opacity-50"
          />
          <p>Nenhuma transação encontrada</p>
          <p class="text-sm mt-1">
            Clique em "Nova Transação" para adicionar sua primeira transação
          </p>
        </div>
        }
      </div>
    </div>

    <!-- Mobile Cards -->
    <div class="md:hidden divide-y divide-gray-800">
      @for (transaction of transactionService.transactions(); track
      transaction.id) {
      <div class="p-4 hover:bg-gray-900/50 transition-colors">
        <div class="flex items-start justify-between mb-2">
          <div class="flex items-center gap-3">
            <div class="p-2 rounded-full bg-gray-800">
              <lucide-angular
                [img]="getCategoryIcon(transaction.type)"
                [class]="getCategoryColor(transaction.type)"
                class="h-4 w-4"
              />
            </div>
            <div>
              <p class="font-medium text-gray-100">{{ transaction.title }}</p>
              <p class="text-sm text-gray-400">
                {{ getCategoryName(transaction.categoryId) }}
              </p>
            </div>
          </div>
          <p [class]="getCategoryColor(transaction.type)">
            {{ formatCurrency(transaction.amount) }}
          </p>
        </div>

        <div class="flex justify-between items-center text-sm text-gray-400">
          <span>{{ formatDate(transaction.date) }}</span>
          <div class="flex gap-2">
            <button
              (click)="openEditForm(transaction)"
              class="p-1 text-gray-400 hover:text-gray-100 transition-colors"
            >
              <lucide-angular [img]="pencilIcon" class="h-4 w-4" />
            </button>
            <button
              (click)="deleteTransaction(transaction.id)"
              class="p-1 text-red-400 hover:text-red-100 transition-colors"
            >
              <lucide-angular [img]="trashIcon" class="h-4 w-4" />
            </button>
          </div>
        </div>
      </div>
      } @empty {
      <div class="p-8 text-center text-gray-500">
        <lucide-angular
          [img]="listIcon"
          class="h-12 w-12 mx-auto mb-4 opacity-50"
        />
        <p>Nenhuma transação encontrada</p>
      </div>
      }
    </div>
  </div>

  <!-- Transaction Form -->
  <app-transaction-form
    [open]="showForm()"
    [transaction]="editingTransaction()"
    (openChange)="onFormClose($event)"
    (onSave)="onTransactionSave($event)"
  />
</div>
